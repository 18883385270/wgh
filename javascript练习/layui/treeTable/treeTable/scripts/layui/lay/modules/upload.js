/** layui-v1.0.9_rls MIT License By http://www.layui.com */
 ;layui.define("layer",function(e){"use strict";var a=layui.jquery,t=layui.layer,i=(layui.device(),"layui-upload-iframe"),n={icon:2,shift:6},r={file:"文件",video:"视频",audio:"音频"},o=function(e){this.options=e};o.prototype.init=function(){var e=this,t=e.options,n=a("body"),o=a(t.elem||".layui-upload-file"),u=a('<iframe id="'+i+'" class="'+i+'" name="'+i+'"></iframe>');return a("#"+i)[0]||n.append(u),o.each(function(n,o){o=a(o);var u='<form target="'+i+'" method="'+(t.method||"post")+'" key="set-mine" enctype="multipart/form-data" action="'+(t.url||"")+'"></form>',s=o.attr("lay-type")||t.type;t.unwrap||(u='<div class="layui-box layui-upload-button">'+u+'<span class="layui-upload-icon"><i class="layui-icon">&#xe608;</i>'+(o.attr("lay-title")||t.title||"上传"+(r[s]||"图片"))+"</span></div>"),u=a(u),t.unwrap||u.on("dragover",function(e){e.preventDefault(),a(this).addClass("layui-upload-enter")}).on("dragleave",function(){a(this).removeClass("layui-upload-enter")}).on("drop",function(){a(this).removeClass("layui-upload-enter")}),o.parent("form").attr("target")===i&&(t.unwrap?o.unwrap():(o.parent().next().remove(),o.unwrap().unwrap())),o.wrap(u),o.off("change").on("change",function(){e.action(this,s)})})},o.prototype.action=function(e,r){var o=this,u=o.options,s=e.value,l=a(e),p=l.attr("lay-ext")||u.ext||"";if(s){switch(r){case"file":if(p&&!RegExp("\\w\\.("+p+")$","i").test(escape(s)))return t.msg("不支持该文件格式",n),e.value="";break;case"video":if(!RegExp("\\w\\.("+(p||"avi|mp4|wma|rmvb|rm|flash|3gp|flv")+")$","i").test(escape(s)))return t.msg("不支持该视频格式",n),e.value="";break;case"audio":if(!RegExp("\\w\\.("+(p||"mp3|wav|mid")+")$","i").test(escape(s)))return t.msg("不支持该音频格式",n),e.value="";break;default:if(!RegExp("\\w\\.("+(p||"jpg|png|gif|bmp|jpeg")+")$","i").test(escape(s)))return t.msg("不支持该图片格式",n),e.value=""}u.before&&u.before(e),l.parent().submit();var c=a("#"+i),f=setInterval(function(){var a;try{a=c.contents().find("body").text()}catch(e){t.msg("上传接口存在跨域",n),clearInterval(f)}if(a){clearInterval(f),c.contents().find("body").html("");try{a=JSON.parse(a)}catch(e){return a={},t.msg("请对上传接口返回JSON字符",n)}"function"==typeof u.success&&u.success(a,e)}},30);e.value=""}},e("upload",function(e){new o(e=e||{}).init()})});